/* How it Works Section - Mobile First */
.how-it-works {
  position: relative;
  z-index: 1;
  background-color: transparent;
  padding: 0 var(--spacing-3);
  margin-bottom: 192px; /* 24 * 8px - větší mezery */
  overflow: visible;
}

.how-it-works__container {
  max-width: 1200px;
  margin: 0 auto;
}

.how-it-works__main-title {
  font-size: 40px; /* 5 * 8px */
  font-weight: 700;
  text-align: center;
  margin-bottom: var(--spacing-8);
  color: var(--color-text);
  max-width: 600px;
  margin-left: auto;
  margin-right: auto;
}

.how-it-works__feature {
  text-align: center;
}

.how-it-works__feature--two-mockups {
  margin-top: 192px; /* 24 * 8px - větší mezery */
}

.how-it-works__feature-title {
  font-size: 32px; /* 4 * 8px */
  font-weight: 700;
  margin-bottom: var(--spacing-3);
  color: var(--color-text);
  display: inline-block;
  position: relative;
  width: fit-content; /* Hug content width */
  max-width: 600px;
}

/* Prevent text wrapping for currency feature title */
.how-it-works__feature--currency .how-it-works__feature-title {
  white-space: nowrap;
}

/* Adjust underline for currency feature title */
.how-it-works__feature--currency .how-it-works__underline {
  width: 100%; /* Full width of the nowrap text */
}

.how-it-works__underline {
  position: absolute;
  bottom: -8px;
  left: 0;
  right: 0;
  width: auto; /* Auto width to match text width */
  height: 2px;
  background-color: var(--color-brand);
  border-radius: 2px;
}

.how-it-works__feature-description {
  font-size: 18px;
  line-height: 1.5;
  color: var(--color-text);
  opacity: 0.9;
  margin-bottom: var(--spacing-6);
  max-width: 600px;
  margin-left: auto;
  margin-right: auto;
}

.how-it-works__mockups {
  position: relative;
  display: grid;
  grid-template-columns: 1fr;
  justify-items: center;
  align-items: center;
  padding: var(--spacing-4) 0;
  min-height: 360px;
}

.how-it-works__mockup {
  grid-column: 1;
  grid-row: 1;
}

.how-it-works__mockup--center {
  z-index: 3;
  opacity: 1;
}

.how-it-works__mockup--left {
  z-index: 2;
  opacity: 0;
  transform: translateX(0) scale(0.8);
  transition: transform 600ms cubic-bezier(0.34, 1.56, 0.64, 1) 0ms,
              opacity 600ms ease 0ms;
}

.how-it-works__mockup--right {
  z-index: 2;
  opacity: 0;
  transform: translateX(0) scale(0.8);
  transition: transform 600ms cubic-bezier(0.34, 1.56, 0.64, 1) 150ms,
              opacity 600ms ease 150ms;
}

/* Animation active state */
.how-it-works__feature--animate .how-it-works__mockup--left {
  opacity: 1;
  transform: translateX(-110px) scale(0.85) rotate(-12deg);
  animation: float-create-left 4s ease-in-out infinite;
  animation-delay: 900ms;
}

.how-it-works__feature--animate .how-it-works__mockup--right {
  opacity: 1;
  transform: translateX(110px) scale(0.85) rotate(12deg);
  animation: float-create-right 3s ease-in-out infinite;
  animation-delay: 600ms;
}

.how-it-works__feature--animate .how-it-works__mockup--center {
  transform: translateX(0) scale(1) rotate(0deg);
  animation: float-create-center 3.5s ease-in-out infinite;
  animation-delay: 750ms;
}

.how-it-works__mockup-img {
  height: 380px; /* 47.5 * 8px - zvětšeno pro mobil */
  width: auto;
  display: block;
}

/* Two Mockups Animation - Invite Friends */
.how-it-works__mockups--two {
  position: relative;
  display: grid;
  grid-template-columns: 1fr;
  justify-items: center;
  align-items: center;
  padding: var(--spacing-4) 0;
  min-height: 360px;
}

.how-it-works__mockups--two .how-it-works__mockup {
  grid-column: 1;
  grid-row: 1;
}

/* Right mockup (starts centered, moves right) */
.how-it-works__mockup--right-dual {
  z-index: 2;
  opacity: 1;
  transform: translateX(0);
  transition: transform 600ms cubic-bezier(0.34, 1.56, 0.64, 1) 0ms;
}

/* Left mockup (starts hidden behind right, slides out left) */
.how-it-works__mockup--left-dual {
  z-index: 1;
  opacity: 0;
  transform: translateX(60px) scale(0.9);
  transition: transform 600ms cubic-bezier(0.34, 1.56, 0.64, 1) 100ms,
              opacity 600ms ease 100ms;
}

/* Animation active state for two mockups */
.how-it-works__feature--two-mockups.how-it-works__feature--animate .how-it-works__mockup--right-dual {
  transform: translateX(60px);
  animation: float-invite-right 3s ease-in-out infinite;
  animation-delay: 600ms;
}

.how-it-works__feature--two-mockups.how-it-works__feature--animate .how-it-works__mockup--left-dual {
  opacity: 1;
  transform: translateX(-60px) scale(1) rotate(-5deg);
  animation: float-invite-left 3.5s ease-in-out infinite;
  animation-delay: 700ms;
}

/* Three Mockups Cascade Animation - Add Transactions */
.how-it-works__feature--three-mockups {
  margin-top: 192px; /* 24 * 8px - větší mezery */
}

.how-it-works__mockups--three {
  position: relative;
  display: grid;
  grid-template-columns: 1fr;
  justify-items: center;
  align-items: center;
  padding: var(--spacing-4) 0;
  min-height: 360px;
}

.how-it-works__mockups--three .how-it-works__mockup {
  grid-column: 1;
  grid-row: 1;
}

/* Right mockup - starts straight (no rotation), visible from start */
.how-it-works__mockup--right-cascade {
  z-index: 5;
  opacity: 1;
  transform: translateX(140px) translateY(20px) scale(1.1) rotate(5deg);
  transition: transform 600ms cubic-bezier(0.34, 1.56, 0.64, 1) 0ms;
}

/* Floating animation for right mockup */
@keyframes float-right {
  0%, 100% {
    transform: translateX(90px) translateY(20px) scale(1.1) rotate(5deg);
  }
  50% {
    transform: translateX(90px) translateY(15px) scale(1.1) rotate(6deg);
  }
}

.how-it-works__feature--animate .how-it-works__mockup--right-cascade {
  animation: float-right 3s ease-in-out infinite;
}

/* Floating animations for center and left mockups */
@keyframes float-center {
  0%, 100% {
    transform: translateX(0) translateY(25px) scale(0.9) rotate(0deg);
  }
  50% {
    transform: translateX(0) translateY(20px) scale(0.9) rotate(-1deg);
  }
}

@keyframes float-left {
  0%, 100% {
    transform: translateX(-70px) translateY(40px) scale(0.75) rotate(-5deg);
  }
  50% {
    transform: translateX(-70px) translateY(35px) scale(0.75) rotate(-6deg);
  }
}

.how-it-works__feature--animate .how-it-works__mockup--center-cascade {
  animation: float-center 3.5s ease-in-out infinite;
}

.how-it-works__feature--animate .how-it-works__mockup--left-cascade {
  animation: float-left 4s ease-in-out infinite;
}

/* Floating animations for invite friends mockups */
@keyframes float-invite-right {
  0%, 100% {
    transform: translateX(60px) translateY(0) rotate(0deg);
  }
  50% {
    transform: translateX(60px) translateY(-5px) rotate(1deg);
  }
}

@keyframes float-invite-left {
  0%, 100% {
    transform: translateX(-60px) scale(1) rotate(-5deg);
  }
  50% {
    transform: translateX(-60px) scale(1) rotate(-6deg) translateY(-5px);
  }
}

/* Center mockup - starts from RIGHT position, slides to center */
.how-it-works__mockup--center-cascade {
  z-index: 3;
  opacity: 0;
  transform: translateX(80px) translateY(10px) scale(0.6);
  transition: transform 600ms cubic-bezier(0.34, 1.56, 0.64, 1) 150ms,
              opacity 600ms ease 150ms;
}

/* Left mockup (New transaction screen) - starts from RIGHT position, slides to left */
.how-it-works__mockup--left-cascade {
  z-index: 1;
  opacity: 0;
  transform: translateX(80px) translateY(10px) scale(0.6);
  transition: transform 600ms cubic-bezier(0.34, 1.56, 0.64, 1) 300ms,
              opacity 600ms ease 300ms;
}

/* Animation active state for three mockups cascade */
.how-it-works__feature--three-mockups.how-it-works__feature--animate .how-it-works__mockup--right-cascade {
  opacity: 1;
  transform: translateX(90px) translateY(20px) scale(1.1) rotate(5deg);
}

.how-it-works__feature--three-mockups.how-it-works__feature--animate .how-it-works__mockup--center-cascade {
  opacity: 1;
  transform: translateX(0) translateY(25px) scale(0.9) rotate(0deg);
  animation: float-center 3.5s ease-in-out infinite;
  animation-delay: 600ms; /* Start floating after slide-in completes */
}

.how-it-works__feature--three-mockups.how-it-works__feature--animate .how-it-works__mockup--left-cascade {
  opacity: 1;
  transform: translateX(-70px) translateY(40px) scale(0.75) rotate(-5deg);
  animation: float-left 4s ease-in-out infinite;
  animation-delay: 900ms; /* Start floating after slide-in completes */
}

/* Bottom-Up Animation - Split the Bills */
.how-it-works__feature--bottom-up {
  margin-top: 192px; /* 24 * 8px - větší mezery */
}

.how-it-works__mockups--bottom {
  position: relative;
  display: grid;
  grid-template-columns: 1fr;
  justify-items: center;
  align-items: center;
  padding: var(--spacing-4) 0;
  min-height: 360px;
}

.how-it-works__mockups--bottom .how-it-works__mockup {
  grid-column: 1;
  grid-row: 1;
}

/* Right mockup (starts below viewport, slides up first) */
.how-it-works__mockup--right-bottom {
  z-index: 2;
  opacity: 0;
  transform: translateY(150px) rotate(5deg);
  transition: transform 700ms cubic-bezier(0.34, 1.56, 0.64, 1) 0ms,
              opacity 700ms ease 0ms;
}

/* Left mockup (starts below viewport, slides up later) */
.how-it-works__mockup--left-bottom {
  z-index: 1;
  opacity: 0;
  transform: translateY(150px) rotate(-5deg);
  transition: transform 700ms cubic-bezier(0.34, 1.56, 0.64, 1) 200ms,
              opacity 700ms ease 200ms;
}

/* Animation active state for bottom-up mockups */
.how-it-works__feature--bottom-up.how-it-works__feature--animate .how-it-works__mockup--right-bottom {
  opacity: 1;
  transform: translateX(60px) translateY(0) rotate(5deg);
  animation: float-split-right 3s ease-in-out infinite;
  animation-delay: 700ms;
}

.how-it-works__feature--bottom-up.how-it-works__feature--animate .how-it-works__mockup--left-bottom {
  opacity: 1;
  transform: translateX(-60px) translateY(0) rotate(-5deg);
  animation: float-split-left 3.5s ease-in-out infinite;
  animation-delay: 900ms;
}

/* No Credit Card Required - Single Image */
.how-it-works__feature--no-card {
  margin-top: 192px; /* 24 * 8px - větší mezery */
  overflow: visible;
}

/* No margin for this feature's description */
.how-it-works__feature--no-card .how-it-works__feature-description {
  margin-bottom: 0; /* No spacing */
}

.how-it-works__mockups--single {
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: var(--spacing-6) var(--spacing-6);
  overflow: visible;
  margin-left: calc(var(--spacing-3) * -1);
  margin-right: calc(var(--spacing-3) * -1);
}

.how-it-works__single-img {
  width: 100%;
  max-width: 480px;
  height: auto;
  display: block;
  padding-top: var(--spacing-3);
  padding-bottom: var(--spacing-3);
  margin: 0 auto;
  overflow: visible;
}

/* Broken card animation - triggers on scroll */
.how-it-works__single-img #card-left,
.how-it-works__single-img #card-right {
  transition: transform 600ms cubic-bezier(0.34, 1.56, 0.64, 1), filter 600ms ease;
  transform-origin: center center;
  position: relative;
  filter: drop-shadow(0 0 0px rgba(160, 87, 255, 0));
  transform: translateX(0) translateY(0) rotate(0deg) scale(0.6);
  -webkit-transform: translateX(0) translateY(0) rotate(0deg) scale(0.6);
  backface-visibility: hidden;
  -webkit-backface-visibility: hidden;
}

/* Explicitly disable any pseudo-elements on cards */
.how-it-works__single-img #card-left::before,
.how-it-works__single-img #card-left::after,
.how-it-works__single-img #card-right::before,
.how-it-works__single-img #card-right::after {
  content: none !important;
  display: none !important;
}

/* Disable pseudo-elements on container */
.how-it-works__mockups--single::before,
.how-it-works__mockups--single::after {
  content: none !important;
  display: none !important;
}

/* Animated state - cards split apart */
.how-it-works__feature--animate .how-it-works__single-img #card-left {
  transform: translateX(-35px) translateY(15px) rotate(-8deg) scale(0.6);
  -webkit-transform: translateX(-35px) translateY(15px) rotate(-8deg) scale(0.6);
  filter: drop-shadow(0 0 12px rgba(160, 87, 255, 0.4)) brightness(1.05);
  -webkit-filter: drop-shadow(0 0 12px rgba(160, 87, 255, 0.4)) brightness(1.05);
  animation: card-float-left 4s ease-in-out infinite;
  -webkit-animation: card-float-left 4s ease-in-out infinite;
  animation-delay: 800ms;
  -webkit-animation-delay: 800ms;
}

.how-it-works__feature--animate .how-it-works__single-img #card-right {
  transform: translateX(35px) translateY(-15px) rotate(8deg) scale(0.6);
  -webkit-transform: translateX(35px) translateY(-15px) rotate(8deg) scale(0.6);
  filter: drop-shadow(0 0 12px rgba(160, 87, 255, 0.4)) brightness(1.05);
  -webkit-filter: drop-shadow(0 0 12px rgba(160, 87, 255, 0.4)) brightness(1.05);
  animation: card-float-right 3.5s ease-in-out infinite;
  -webkit-animation: card-float-right 3.5s ease-in-out infinite;
  animation-delay: 600ms;
  -webkit-animation-delay: 600ms;
}

/* Mobile only - larger cards */
@media (max-width: 767px) {
  .how-it-works__single-img #card-left,
  .how-it-works__single-img #card-right {
    transform: translateX(0) translateY(0) rotate(0deg) scale(0.9);
  }

  .how-it-works__feature--animate .how-it-works__single-img #card-left {
    transform: translateX(-35px) translateY(15px) rotate(-8deg) scale(0.9);
    -webkit-transform: translateX(-35px) translateY(15px) rotate(-8deg) scale(0.9);
    animation: card-float-left-mobile 4s ease-in-out infinite;
    -webkit-animation: card-float-left-mobile 4s ease-in-out infinite;
  }

  .how-it-works__feature--animate .how-it-works__single-img #card-right {
    transform: translateX(35px) translateY(-15px) rotate(8deg) scale(0.9);
    -webkit-transform: translateX(35px) translateY(-15px) rotate(8deg) scale(0.9);
    animation: card-float-right-mobile 3.5s ease-in-out infinite;
    -webkit-animation: card-float-right-mobile 3.5s ease-in-out infinite;
  }

  /* Mobile keyframes with larger scale */
  @keyframes card-float-left-mobile {
    0%, 100% {
      transform: translateX(-35px) translateY(15px) rotate(-8deg) scale(0.9);
      -webkit-transform: translateX(-35px) translateY(15px) rotate(-8deg) scale(0.9);
      filter: drop-shadow(0 0 12px rgba(160, 87, 255, 0.4)) brightness(1.05);
      -webkit-filter: drop-shadow(0 0 12px rgba(160, 87, 255, 0.4)) brightness(1.05);
    }
    50% {
      transform: translateX(-38px) translateY(18px) rotate(-9deg) scale(0.92);
      -webkit-transform: translateX(-38px) translateY(18px) rotate(-9deg) scale(0.92);
      filter: drop-shadow(0 0 16px rgba(160, 87, 255, 0.5)) brightness(1.08);
      -webkit-filter: drop-shadow(0 0 16px rgba(160, 87, 255, 0.5)) brightness(1.08);
    }
  }

  @-webkit-keyframes card-float-left-mobile {
    0%, 100% {
      -webkit-transform: translateX(-35px) translateY(15px) rotate(-8deg) scale(0.9);
      -webkit-filter: drop-shadow(0 0 12px rgba(160, 87, 255, 0.4)) brightness(1.05);
    }
    50% {
      -webkit-transform: translateX(-38px) translateY(18px) rotate(-9deg) scale(0.92);
      -webkit-filter: drop-shadow(0 0 16px rgba(160, 87, 255, 0.5)) brightness(1.08);
    }
  }

  @keyframes card-float-right-mobile {
    0%, 100% {
      transform: translateX(35px) translateY(-15px) rotate(8deg) scale(0.9);
      -webkit-transform: translateX(35px) translateY(-15px) rotate(8deg) scale(0.9);
      filter: drop-shadow(0 0 12px rgba(160, 87, 255, 0.4)) brightness(1.05);
      -webkit-filter: drop-shadow(0 0 12px rgba(160, 87, 255, 0.4)) brightness(1.05);
    }
    50% {
      transform: translateX(38px) translateY(-18px) rotate(9deg) scale(0.92);
      -webkit-transform: translateX(38px) translateY(-18px) rotate(9deg) scale(0.92);
      filter: drop-shadow(0 0 16px rgba(160, 87, 255, 0.5)) brightness(1.08);
      -webkit-filter: drop-shadow(0 0 16px rgba(160, 87, 255, 0.5)) brightness(1.08);
    }
  }

  @-webkit-keyframes card-float-right-mobile {
    0%, 100% {
      -webkit-transform: translateX(35px) translateY(-15px) rotate(8deg) scale(0.9);
      -webkit-filter: drop-shadow(0 0 12px rgba(160, 87, 255, 0.4)) brightness(1.05);
    }
    50% {
      -webkit-transform: translateX(38px) translateY(-18px) rotate(9deg) scale(0.92);
      -webkit-filter: drop-shadow(0 0 16px rgba(160, 87, 255, 0.5)) brightness(1.08);
    }
  }
}

/* Tablet - 768px and up */
@media (min-width: 768px) {
  .how-it-works {
    padding: var(--spacing-8) var(--spacing-5);
  }

  .how-it-works__main-title {
    font-size: 56px; /* 7 * 8px */
  }

  .how-it-works__feature-title {
    font-size: 40px; /* 5 * 8px */
  }

  .how-it-works__underline {
    bottom: -12px;
    height: 6px;
  }

  .how-it-works__feature-description {
    font-size: 20px;
    max-width: 700px;
  }

  .how-it-works__mockups {
    min-height: 420px;
  }

  .how-it-works__mockup-img {
    height: 400px; /* 50 * 8px */
  }

  .how-it-works__feature--animate .how-it-works__mockup--left {
    transform: translateX(-140px) scale(0.9) rotate(-5deg);
    animation: float-create-left-tablet 4s ease-in-out infinite;
    animation-delay: 900ms;
  }

  .how-it-works__feature--animate .how-it-works__mockup--right {
    transform: translateX(140px) scale(0.9) rotate(5deg);
    animation: float-create-right-tablet 3s ease-in-out infinite;
    animation-delay: 600ms;
  }

  .how-it-works__feature--animate .how-it-works__mockup--center {
    transform: translateX(0) scale(1) rotate(0deg);
    animation: float-create-center-tablet 3.5s ease-in-out infinite;
    animation-delay: 750ms;
  }

  /* Two mockups - tablet */
  .how-it-works__mockups--two {
    min-height: 420px;
  }

  .how-it-works__feature--two-mockups.how-it-works__feature--animate .how-it-works__mockup--right-dual {
    transform: translateX(80px);
    animation: float-invite-right-tablet 3s ease-in-out infinite;
    animation-delay: 600ms;
  }

  .how-it-works__feature--two-mockups.how-it-works__feature--animate .how-it-works__mockup--left-dual {
    transform: translateX(-80px) scale(1) rotate(-5deg);
    animation: float-invite-left-tablet 3.5s ease-in-out infinite;
    animation-delay: 700ms;
  }

  /* Three mockups - tablet */
  .how-it-works__mockups--three {
    min-height: 420px;
  }

  .how-it-works__feature--three-mockups.how-it-works__feature--animate .how-it-works__mockup--right-cascade {
    opacity: 1;
    transform: translateX(100px) translateY(20px) scale(1.0) rotate(5deg);
  }

  .how-it-works__feature--three-mockups.how-it-works__feature--animate .how-it-works__mockup--center-cascade {
    opacity: 1;
    transform: translateX(0) translateY(40px) scale(0.7) rotate(0deg);
  }

  .how-it-works__feature--three-mockups.how-it-works__feature--animate .how-it-works__mockup--left-cascade {
    opacity: 1;
    transform: translateX(-100px) translateY(60px) scale(0.5) rotate(-5deg);
  }

  /* Bottom-up mockups - tablet */
  .how-it-works__mockups--bottom {
    min-height: 420px;
  }

  .how-it-works__feature--bottom-up.how-it-works__feature--animate .how-it-works__mockup--right-bottom {
    transform: translateX(80px) translateY(0) rotate(5deg);
    animation: float-split-right-tablet 3s ease-in-out infinite;
    animation-delay: 700ms;
  }

  .how-it-works__feature--bottom-up.how-it-works__feature--animate .how-it-works__mockup--left-bottom {
    transform: translateX(-80px) translateY(0) rotate(-5deg);
    animation: float-split-left-tablet 3.5s ease-in-out infinite;
    animation-delay: 900ms;
  }

  /* Single image - tablet */
  .how-it-works__single-img {
    max-width: 520px;
  }

  /* Basic card state - tablet */
  .how-it-works__single-img #card-left,
  .how-it-works__single-img #card-right {
    transform: translateX(0) translateY(0) rotate(0deg) scale(0.65);
  }

  /* Broken card animation - tablet (stronger effect) */
  .how-it-works__feature--animate .how-it-works__single-img #card-left {
    transform: translateX(-40px) translateY(18px) rotate(-8deg) scale(0.65);
    filter: drop-shadow(0 0 14px rgba(160, 87, 255, 0.5)) brightness(1.06);
    animation: card-float-left-tablet 4s ease-in-out infinite;
    animation-delay: 800ms;
  }

  .how-it-works__feature--animate .how-it-works__single-img #card-right {
    transform: translateX(40px) translateY(-18px) rotate(8deg) scale(0.65);
    filter: drop-shadow(0 0 14px rgba(160, 87, 255, 0.5)) brightness(1.06);
    animation: card-float-right-tablet 3.5s ease-in-out infinite;
    animation-delay: 600ms;
  }
}

/* Desktop - 1024px and up */
@media (min-width: 1024px) {
  .how-it-works {
    padding: var(--spacing-8) var(--spacing-7);
  }

  .how-it-works__main-title {
    font-size: 64px; /* 8 * 8px */
  }

  .how-it-works__feature-title {
    font-size: 48px; /* 6 * 8px */
    margin-bottom: var(--spacing-4); /* Normal spacing since we hide short description */
  }

  .how-it-works__feature-description {
    font-size: 22px;
    max-width: 800px;
    margin-bottom: var(--spacing-2); /* Smaller spacing before expanded text */
  }

  /* Split layout for desktop - create a virtual text container */
  .how-it-works__feature--split-layout {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-8);
    align-items: flex-start;
    text-align: left;
    grid-template-areas: "text mockups";
  }

  /* Create groups má větší mezeru kvůli velkým mockupům */
  .how-it-works__feature--create-groups {
    gap: 144px; /* 18 * 8px - ještě větší mezera pro create groups */
  }

  /* Create virtual text container using ::before pseudo-element */
  .how-it-works__feature--split-layout::before {
    content: "";
    grid-area: text;
    display: flex;
    flex-direction: column;
  }

  /* Position text elements in text area - larger spacing */
  .how-it-works__feature--split-layout .how-it-works__feature-title {
    grid-area: text;
    align-self: start;
    margin: 0 !important; /* Remove original margin-bottom */
    margin-bottom: 0 !important; /* Force no bottom margin */
    padding: 0 !important;
    width: fit-content !important; /* Hug content width */
    max-width: 100%;
  }

  .how-it-works__feature--split-layout .how-it-works__feature-description {
    grid-area: text;
    align-self: start;
    margin: 0 !important;
    padding: 0 !important;
    padding-top: 114px !important; /* Adjusted for 56px spacing */
    padding-bottom: 20px !important; /* Larger space before expanded */
    max-width: 100%;
  }

  .how-it-works__feature--split-layout .how-it-works__feature-description-expanded {
    grid-area: text;
    align-self: start;
    margin: 0 !important;
    padding: 0 !important;
    padding-top: 104px !important; /* Adjusted spacing below title */
    max-width: 100%;
  }

  .how-it-works__feature--split-layout .how-it-works__mockups {
    grid-area: mockups;
    align-self: start;
  }

  /* Reverse layout: text right, mockups left */
  .how-it-works__feature--reverse {
    grid-template-areas: "mockups text" !important;
  }

  /* Adjust underline for split layout - align left and closer to text */
  .how-it-works__feature--split-layout .how-it-works__underline {
    left: 0;
    right: 0;
    bottom: -4px !important; /* Much closer to title text */
    width: auto !important; /* Auto width to match text for split layout too */
  }

  .how-it-works__mockups {
    min-height: 500px;
  }

  .how-it-works__mockup-img {
    height: 480px; /* 60 * 8px */
  }

  .how-it-works__feature--animate .how-it-works__mockup--left {
    transform: translateX(-180px) scale(0.9) rotate(-5deg);
    animation: float-create-left-desktop 4s ease-in-out infinite;
    animation-delay: 900ms;
  }

  .how-it-works__feature--animate .how-it-works__mockup--right {
    transform: translateX(180px) scale(0.9) rotate(5deg);
    animation: float-create-right-desktop 3s ease-in-out infinite;
    animation-delay: 600ms;
  }

  .how-it-works__feature--animate .how-it-works__mockup--center {
    transform: translateX(0) scale(1) rotate(0deg);
    animation: float-create-center-desktop 3.5s ease-in-out infinite;
    animation-delay: 750ms;
  }

  /* Two mockups - desktop */
  .how-it-works__mockups--two {
    min-height: 500px;
  }

  .how-it-works__feature--two-mockups.how-it-works__feature--animate .how-it-works__mockup--right-dual {
    transform: translateX(100px);
    animation: float-invite-right-desktop 3s ease-in-out infinite;
    animation-delay: 600ms;
  }

  .how-it-works__feature--two-mockups.how-it-works__feature--animate .how-it-works__mockup--left-dual {
    transform: translateX(-100px) scale(1) rotate(-5deg);
    animation: float-invite-left-desktop 3.5s ease-in-out infinite;
    animation-delay: 700ms;
  }

  /* Three mockups - desktop */
  .how-it-works__mockups--three {
    min-height: 500px;
  }

  .how-it-works__feature--three-mockups.how-it-works__feature--animate .how-it-works__mockup--right-cascade {
    opacity: 1;
    animation: float-right-desktop 3s ease-in-out infinite;
  }

  .how-it-works__feature--three-mockups.how-it-works__feature--animate .how-it-works__mockup--center-cascade {
    opacity: 1;
    transform: translateX(0) translateY(40px) scale(0.95) rotate(0deg);
    animation: float-center-desktop 3.5s ease-in-out infinite;
    animation-delay: 600ms;
  }

  .how-it-works__feature--three-mockups.how-it-works__feature--animate .how-it-works__mockup--left-cascade {
    opacity: 1;
    transform: translateX(-140px) translateY(60px) scale(0.75) rotate(-5deg);
    animation: float-left-desktop 4s ease-in-out infinite;
    animation-delay: 900ms;
  }

  /* Bottom-up mockups - desktop */
  .how-it-works__mockups--bottom {
    min-height: 500px;
  }

  .how-it-works__feature--bottom-up.how-it-works__feature--animate .how-it-works__mockup--right-bottom {
    transform: translateX(100px) translateY(0) rotate(5deg);
    animation: float-split-right-desktop 3s ease-in-out infinite;
    animation-delay: 700ms;
  }

  .how-it-works__feature--bottom-up.how-it-works__feature--animate .how-it-works__mockup--left-bottom {
    transform: translateX(-100px) translateY(0) rotate(-5deg);
    animation: float-split-left-desktop 3.5s ease-in-out infinite;
    animation-delay: 900ms;
  }

  /* Single image - desktop */
  .how-it-works__single-img {
    max-width: 620px;
  }

  /* Basic card state - desktop */
  .how-it-works__single-img #card-left,
  .how-it-works__single-img #card-right {
    transform: translateX(0) translateY(0) rotate(0deg) scale(0.7);
  }

  /* Broken card animation - desktop (even stronger effect) */
  .how-it-works__feature--animate .how-it-works__single-img #card-left {
    transform: translateX(-45px) translateY(22px) rotate(-9deg) scale(0.7);
    filter: drop-shadow(0 0 16px rgba(160, 87, 255, 0.6)) brightness(1.08);
    animation: card-float-left-desktop 4s ease-in-out infinite;
    animation-delay: 800ms;
  }

  .how-it-works__feature--animate .how-it-works__single-img #card-right {
    transform: translateX(45px) translateY(-22px) rotate(9deg) scale(0.7);
    filter: drop-shadow(0 0 16px rgba(160, 87, 255, 0.6)) brightness(1.08);
    animation: card-float-right-desktop 3.5s ease-in-out infinite;
    animation-delay: 600ms;
  }
}

/* Large Desktop - 1440px and up */
@media (min-width: 1440px) {
  .how-it-works {
    padding: var(--spacing-8);
  }

  .how-it-works__main-title {
    font-size: 72px; /* 9 * 8px */
  }

  .how-it-works__feature-title {
    font-size: 56px; /* 7 * 8px */
  }

  .how-it-works__feature-description {
    font-size: 24px;
  }

  .how-it-works__feature-description-expanded p {
    font-size: 24px;
  }

  /* Split layout - keep grid structure from 1024px breakpoint */
  .how-it-works__feature--split-layout {
    gap: 96px; /* Larger gap on large desktop */
  }

  /* Create groups má ještě větší mezeru na velkém desktopu */
  .how-it-works__feature--create-groups {
    gap: 192px; /* 24 * 8px - ideální mezera pro create groups */
  }

  .how-it-works__mockups {
    min-height: 560px;
  }

  .how-it-works__mockup-img {
    height: 520px; /* 65 * 8px */
  }

  .how-it-works__feature--animate .how-it-works__mockup--left {
    transform: translateX(-220px) scale(0.9) rotate(-5deg);
    animation: float-create-left-large 4s ease-in-out infinite;
    animation-delay: 900ms;
  }

  .how-it-works__feature--animate .how-it-works__mockup--right {
    transform: translateX(220px) scale(0.9) rotate(5deg);
    animation: float-create-right-large 3s ease-in-out infinite;
    animation-delay: 600ms;
  }

  .how-it-works__feature--animate .how-it-works__mockup--center {
    transform: translateX(0) scale(1) rotate(0deg);
    animation: float-create-center-large 3.5s ease-in-out infinite;
    animation-delay: 750ms;
  }

  /* Two mockups - large desktop */
  .how-it-works__mockups--two {
    min-height: 560px;
  }

  .how-it-works__feature--two-mockups.how-it-works__feature--animate .how-it-works__mockup--right-dual {
    transform: translateX(120px);
    animation: float-invite-right-large 3s ease-in-out infinite;
    animation-delay: 600ms;
  }

  .how-it-works__feature--two-mockups.how-it-works__feature--animate .how-it-works__mockup--left-dual {
    transform: translateX(-120px) scale(1) rotate(-5deg);
    animation: float-invite-left-large 3.5s ease-in-out infinite;
    animation-delay: 700ms;
  }

  /* Three mockups - large desktop */
  .how-it-works__mockups--three {
    min-height: 560px;
  }

  .how-it-works__feature--three-mockups.how-it-works__feature--animate .how-it-works__mockup--right-cascade {
    opacity: 1;
    animation: float-right-desktop 3s ease-in-out infinite;
  }

  .how-it-works__feature--three-mockups.how-it-works__feature--animate .how-it-works__mockup--center-cascade {
    opacity: 1;
    transform: translateX(0) translateY(40px) scale(0.95) rotate(0deg);
    animation: float-center-desktop 3.5s ease-in-out infinite;
    animation-delay: 600ms;
  }

  .how-it-works__feature--three-mockups.how-it-works__feature--animate .how-it-works__mockup--left-cascade {
    opacity: 1;
    transform: translateX(-140px) translateY(60px) scale(0.75) rotate(-5deg);
    animation: float-left-desktop 4s ease-in-out infinite;
    animation-delay: 900ms;
  }

  /* Bottom-up mockups - large desktop */
  .how-it-works__mockups--bottom {
    min-height: 560px;
  }

  .how-it-works__feature--bottom-up.how-it-works__feature--animate .how-it-works__mockup--right-bottom {
    transform: translateX(120px) translateY(0) rotate(5deg);
    animation: float-split-right-large 3s ease-in-out infinite;
    animation-delay: 700ms;
  }

  .how-it-works__feature--bottom-up.how-it-works__feature--animate .how-it-works__mockup--left-bottom {
    transform: translateX(-120px) translateY(0) rotate(-5deg);
    animation: float-split-left-large 3.5s ease-in-out infinite;
    animation-delay: 900ms;
  }

  /* Single image - large desktop */
  .how-it-works__single-img {
    max-width: 680px;
  }

  /* Basic card state - large desktop */
  .how-it-works__single-img #card-left,
  .how-it-works__single-img #card-right {
    transform: translateX(0) translateY(0) rotate(0deg) scale(0.75);
  }

  /* Broken card animation - large desktop (strongest effect) */
  .how-it-works__feature--animate .how-it-works__single-img #card-left {
    transform: translateX(-50px) translateY(25px) rotate(-10deg) scale(0.75);
    filter: drop-shadow(0 0 20px rgba(160, 87, 255, 0.7)) brightness(1.1);
    animation: card-float-left-large 4s ease-in-out infinite;
    animation-delay: 800ms;
  }

  .how-it-works__feature--animate .how-it-works__single-img #card-right {
    transform: translateX(50px) translateY(-25px) rotate(10deg) scale(0.75);
    filter: drop-shadow(0 0 20px rgba(160, 87, 255, 0.7)) brightness(1.1);
    animation: card-float-right-large 3.5s ease-in-out infinite;
    animation-delay: 600ms;
  }
}

/* Feature descriptions responsivity */
/* Hide expanded descriptions on mobile/tablet by default */
.how-it-works__feature-description-expanded {
  display: none;
}

/* Desktop - 1024px and up: Show expanded descriptions, hide short descriptions */
@media (min-width: 1024px) {
  .how-it-works__feature-description {
    display: none; /* Hide short mobile text on desktop */
  }

  .how-it-works__feature-description-expanded {
    display: block;
    margin-top: 0; /* No gap since we hide short description */
  }

  /* Exception: Show short description for "no credit card" feature */
  .how-it-works__feature--no-card .how-it-works__feature-description {
    display: block; /* Show short text for this feature */
  }

  .how-it-works__feature--no-card .how-it-works__feature-description-expanded {
    display: none; /* Hide expanded text for this feature */
  }

  .how-it-works__feature-description-expanded p {
    font-size: 22px;
    line-height: 1.6;
    color: var(--color-text);
    margin-bottom: var(--spacing-2); /* Smaller spacing between paragraphs */
    max-width: 800px;
    margin-left: auto;
    margin-right: auto;
  }

  .how-it-works__feature-description-expanded p:last-child {
    margin-bottom: var(--spacing-2); /* Much smaller spacing after expanded text */
  }
}

/* Desktop floating animation keyframes */
@keyframes float-right-desktop {
  0%, 100% {
    transform: translateX(140px) translateY(20px) scale(1.1) rotate(5deg);
  }
  50% {
    transform: translateX(140px) translateY(15px) scale(1.1) rotate(9deg);
  }
}

@keyframes float-center-desktop {
  0%, 100% {
    transform: translateX(0) translateY(40px) scale(0.95) rotate(0deg);
  }
  50% {
    transform: translateX(0) translateY(35px) scale(0.95) rotate(-1deg);
  }
}

@keyframes float-left-desktop {
  0%, 100% {
    transform: translateX(-140px) translateY(60px) scale(0.75) rotate(-5deg);
  }
  50% {
    transform: translateX(-140px) translateY(55px) scale(0.75) rotate(-9deg);
  }
}

/* Invite friends floating animations - tablet */
@keyframes float-invite-right-tablet {
  0%, 100% {
    transform: translateX(80px) translateY(0) rotate(0deg);
  }
  50% {
    transform: translateX(80px) translateY(-5px) rotate(1deg);
  }
}

@keyframes float-invite-left-tablet {
  0%, 100% {
    transform: translateX(-80px) scale(1) rotate(-5deg);
  }
  50% {
    transform: translateX(-80px) scale(1) rotate(-6deg) translateY(-5px);
  }
}

/* Invite friends floating animations - desktop */
@keyframes float-invite-right-desktop {
  0%, 100% {
    transform: translateX(100px) translateY(0) rotate(0deg);
  }
  50% {
    transform: translateX(100px) translateY(-5px) rotate(1deg);
  }
}

@keyframes float-invite-left-desktop {
  0%, 100% {
    transform: translateX(-100px) scale(1) rotate(-5deg);
  }
  50% {
    transform: translateX(-100px) scale(1) rotate(-6deg) translateY(-5px);
  }
}

/* Invite friends floating animations - large desktop */
@keyframes float-invite-right-large {
  0%, 100% {
    transform: translateX(120px) translateY(0) rotate(0deg);
  }
  50% {
    transform: translateX(120px) translateY(-5px) rotate(1deg);
  }
}

@keyframes float-invite-left-large {
  0%, 100% {
    transform: translateX(-120px) scale(1) rotate(-5deg);
  }
  50% {
    transform: translateX(-120px) scale(1) rotate(-6deg) translateY(-5px);
  }
}

/* Credit card floating animations */
@keyframes card-float-left {
  0%, 100% {
    transform: translateX(-35px) translateY(15px) rotate(-8deg) scale(0.6);
    -webkit-transform: translateX(-35px) translateY(15px) rotate(-8deg) scale(0.6);
    filter: drop-shadow(0 0 12px rgba(160, 87, 255, 0.4)) brightness(1.05);
    -webkit-filter: drop-shadow(0 0 12px rgba(160, 87, 255, 0.4)) brightness(1.05);
  }
  50% {
    transform: translateX(-38px) translateY(18px) rotate(-9deg) scale(0.61);
    -webkit-transform: translateX(-38px) translateY(18px) rotate(-9deg) scale(0.61);
    filter: drop-shadow(0 0 16px rgba(160, 87, 255, 0.5)) brightness(1.08);
    -webkit-filter: drop-shadow(0 0 16px rgba(160, 87, 255, 0.5)) brightness(1.08);
  }
}

@-webkit-keyframes card-float-left {
  0%, 100% {
    -webkit-transform: translateX(-35px) translateY(15px) rotate(-8deg) scale(0.6);
    -webkit-filter: drop-shadow(0 0 12px rgba(160, 87, 255, 0.4)) brightness(1.05);
  }
  50% {
    -webkit-transform: translateX(-38px) translateY(18px) rotate(-9deg) scale(0.61);
    -webkit-filter: drop-shadow(0 0 16px rgba(160, 87, 255, 0.5)) brightness(1.08);
  }
}

@keyframes card-float-right {
  0%, 100% {
    transform: translateX(35px) translateY(-15px) rotate(8deg) scale(0.6);
    -webkit-transform: translateX(35px) translateY(-15px) rotate(8deg) scale(0.6);
    filter: drop-shadow(0 0 12px rgba(160, 87, 255, 0.4)) brightness(1.05);
    -webkit-filter: drop-shadow(0 0 12px rgba(160, 87, 255, 0.4)) brightness(1.05);
  }
  50% {
    transform: translateX(38px) translateY(-18px) rotate(9deg) scale(0.61);
    -webkit-transform: translateX(38px) translateY(-18px) rotate(9deg) scale(0.61);
    filter: drop-shadow(0 0 16px rgba(160, 87, 255, 0.5)) brightness(1.08);
    -webkit-filter: drop-shadow(0 0 16px rgba(160, 87, 255, 0.5)) brightness(1.08);
  }
}

@-webkit-keyframes card-float-right {
  0%, 100% {
    -webkit-transform: translateX(35px) translateY(-15px) rotate(8deg) scale(0.6);
    -webkit-filter: drop-shadow(0 0 12px rgba(160, 87, 255, 0.4)) brightness(1.05);
  }
  50% {
    -webkit-transform: translateX(38px) translateY(-18px) rotate(9deg) scale(0.61);
    -webkit-filter: drop-shadow(0 0 16px rgba(160, 87, 255, 0.5)) brightness(1.08);
  }
}

/* Credit card floating animations - tablet */
@keyframes card-float-left-tablet {
  0%, 100% {
    transform: translateX(-40px) translateY(18px) rotate(-8deg) scale(0.65);
    filter: drop-shadow(0 0 14px rgba(160, 87, 255, 0.5)) brightness(1.06);
  }
  50% {
    transform: translateX(-43px) translateY(21px) rotate(-9deg) scale(0.66);
    filter: drop-shadow(0 0 18px rgba(160, 87, 255, 0.6)) brightness(1.09);
  }
}

@keyframes card-float-right-tablet {
  0%, 100% {
    transform: translateX(40px) translateY(-18px) rotate(8deg) scale(0.65);
    filter: drop-shadow(0 0 14px rgba(160, 87, 255, 0.5)) brightness(1.06);
  }
  50% {
    transform: translateX(43px) translateY(-21px) rotate(9deg) scale(0.66);
    filter: drop-shadow(0 0 18px rgba(160, 87, 255, 0.6)) brightness(1.09);
  }
}

/* Credit card floating animations - desktop */
@keyframes card-float-left-desktop {
  0%, 100% {
    transform: translateX(-45px) translateY(22px) rotate(-9deg) scale(0.7);
    filter: drop-shadow(0 0 16px rgba(160, 87, 255, 0.6)) brightness(1.08);
  }
  50% {
    transform: translateX(-48px) translateY(25px) rotate(-10deg) scale(0.71);
    filter: drop-shadow(0 0 20px rgba(160, 87, 255, 0.7)) brightness(1.1);
  }
}

@keyframes card-float-right-desktop {
  0%, 100% {
    transform: translateX(45px) translateY(-22px) rotate(9deg) scale(0.7);
    filter: drop-shadow(0 0 16px rgba(160, 87, 255, 0.6)) brightness(1.08);
  }
  50% {
    transform: translateX(48px) translateY(-25px) rotate(10deg) scale(0.71);
    filter: drop-shadow(0 0 20px rgba(160, 87, 255, 0.7)) brightness(1.1);
  }
}

/* Credit card floating animations - large desktop */
@keyframes card-float-left-large {
  0%, 100% {
    transform: translateX(-50px) translateY(25px) rotate(-10deg) scale(0.75);
    filter: drop-shadow(0 0 20px rgba(160, 87, 255, 0.7)) brightness(1.1);
  }
  50% {
    transform: translateX(-53px) translateY(28px) rotate(-11deg) scale(0.76);
    filter: drop-shadow(0 0 24px rgba(160, 87, 255, 0.8)) brightness(1.12);
  }
}

@keyframes card-float-right-large {
  0%, 100% {
    transform: translateX(50px) translateY(-25px) rotate(10deg) scale(0.75);
    filter: drop-shadow(0 0 20px rgba(160, 87, 255, 0.7)) brightness(1.1);
  }
  50% {
    transform: translateX(53px) translateY(-28px) rotate(11deg) scale(0.76);
    filter: drop-shadow(0 0 24px rgba(160, 87, 255, 0.8)) brightness(1.12);
  }
}

/* Create groups floating animations */
@keyframes float-create-left {
  0%, 100% {
    transform: translateX(-110px) translateY(0) scale(0.85) rotate(-12deg);
  }
  50% {
    transform: translateX(-110px) translateY(-5px) scale(0.85) rotate(-13deg);
  }
}

@keyframes float-create-right {
  0%, 100% {
    transform: translateX(110px) translateY(0) scale(0.85) rotate(12deg);
  }
  50% {
    transform: translateX(110px) translateY(-5px) scale(0.85) rotate(13deg);
  }
}

@keyframes float-create-center {
  0%, 100% {
    transform: translateX(0) translateY(0) scale(1) rotate(0deg);
  }
  50% {
    transform: translateX(0) translateY(-3px) scale(1) rotate(1deg);
  }
}

/* Create groups floating animations - tablet */
@keyframes float-create-left-desktop {
  0%, 100% {
    transform: translateX(-140px) translateY(0) scale(0.9) rotate(-5deg);
  }
  50% {
    transform: translateX(-140px) translateY(-5px) scale(0.9) rotate(-6deg);
  }
}

@keyframes float-create-right-desktop {
  0%, 100% {
    transform: translateX(140px) translateY(0) scale(0.9) rotate(5deg);
  }
  50% {
    transform: translateX(140px) translateY(-5px) scale(0.9) rotate(6deg);
  }
}

@keyframes float-create-center-desktop {
  0%, 100% {
    transform: translateX(0) translateY(0) scale(1) rotate(0deg);
  }
  50% {
    transform: translateX(0) translateY(-3px) scale(1) rotate(1deg);
  }
}

/* Split the bills floating animations */
@keyframes float-split-right {
  0%, 100% {
    transform: translateX(60px) translateY(0) rotate(5deg);
  }
  50% {
    transform: translateX(60px) translateY(-5px) rotate(6deg);
  }
}

@keyframes float-split-left {
  0%, 100% {
    transform: translateX(-60px) translateY(0) rotate(-5deg);
  }
  50% {
    transform: translateX(-60px) translateY(-5px) rotate(-6deg);
  }
}

/* Create groups floating animations - desktop */
@keyframes float-create-left-desktop {
  0%, 100% {
    transform: translateX(-180px) translateY(0) scale(0.9) rotate(-5deg);
  }
  50% {
    transform: translateX(-180px) translateY(-5px) scale(0.9) rotate(-6deg);
  }
}

@keyframes float-create-right-desktop {
  0%, 100% {
    transform: translateX(180px) translateY(0) scale(0.9) rotate(5deg);
  }
  50% {
    transform: translateX(180px) translateY(-5px) scale(0.9) rotate(6deg);
  }
}

@keyframes float-create-center-desktop {
  0%, 100% {
    transform: translateX(0) translateY(0) scale(1) rotate(0deg);
  }
  50% {
    transform: translateX(0) translateY(-3px) scale(1) rotate(1deg);
  }
}

/* Split the bills floating animations - tablet */
@keyframes float-split-right-desktop {
  0%, 100% {
    transform: translateX(80px) translateY(0) rotate(5deg);
  }
  50% {
    transform: translateX(80px) translateY(-5px) rotate(6deg);
  }
}

@keyframes float-split-left-desktop {
  0%, 100% {
    transform: translateX(-80px) translateY(0) rotate(-5deg);
  }
  50% {
    transform: translateX(-80px) translateY(-5px) rotate(-6deg);
  }
}

/* Split the bills floating animations - desktop */
@keyframes float-split-right-desktop {
  0%, 100% {
    transform: translateX(100px) translateY(0) rotate(5deg);
  }
  50% {
    transform: translateX(100px) translateY(-5px) rotate(6deg);
  }
}

@keyframes float-split-left-desktop {
  0%, 100% {
    transform: translateX(-100px) translateY(0) rotate(-5deg);
  }
  50% {
    transform: translateX(-100px) translateY(-5px) rotate(-6deg);
  }
}

/* Create groups floating animations - large desktop */
@keyframes float-create-left-large {
  0%, 100% {
    transform: translateX(-220px) translateY(0) scale(0.9) rotate(-5deg);
  }
  50% {
    transform: translateX(-220px) translateY(-5px) scale(0.9) rotate(-6deg);
  }
}

@keyframes float-create-right-large {
  0%, 100% {
    transform: translateX(220px) translateY(0) scale(0.9) rotate(5deg);
  }
  50% {
    transform: translateX(220px) translateY(-5px) scale(0.9) rotate(6deg);
  }
}

@keyframes float-create-center-large {
  0%, 100% {
    transform: translateX(0) translateY(0) scale(1) rotate(0deg);
  }
  50% {
    transform: translateX(0) translateY(-3px) scale(1) rotate(1deg);
  }
}

/* Split the bills floating animations - large desktop */
@keyframes float-split-right-large {
  0%, 100% {
    transform: translateX(120px) translateY(0) rotate(5deg);
  }
  50% {
    transform: translateX(120px) translateY(-5px) rotate(6deg);
  }
}

@keyframes float-split-left-large {
  0%, 100% {
    transform: translateX(-120px) translateY(0) rotate(-5deg);
  }
  50% {
    transform: translateX(-120px) translateY(-5px) rotate(-6deg);
  }
}
